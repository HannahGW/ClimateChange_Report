---
title: "Pasadena"
author: "Hannah Garcia-Wickstrum"
date: "8/11/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(janitor)
library(lubridate)
library(here)
```

```{r}
# Pasadena Temperature: 1909-2019
# Number of Missing Years: 0

pasadena_temp <- read_csv(here::here("csv_files",
                                     "temperature",
                                     "pasadena.csv"))
 

# Create graph of averages (mean, max, and min)

pasadena_temp_graph <- ggplot(data=pasadena_temp, aes(x=year)) +
  geom_line(aes(y=mean), color="black") +
  geom_line(aes(y=max), color="black") +
  geom_line(aes(y=min), color="black") +
  geom_point(aes(y=mean), color="black", pch=18, size=1.5) +
  geom_point(aes(y=max), color="darkred", pch=15, size=1.5) +
  geom_point(aes(y=min), color="gold", pch=17, size=1.5) +
  labs(x="Year", y="Degrees Farenheit", title="Pasadena") +
  scale_x_continuous(limits=c(1908, 2020), breaks=seq(1908,2020,10), expand=c(0,1)) +
  scale_y_continuous(limits=c(45,85), breaks=seq(45,85,5), expand=c(0,0)) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

pasadena_temp_graph
```


```{r}
# Statistics (linear regression (lm)) for mean, max, and min temperature in Pasadena

## Mean model (lm)
meantemp_lm <- lm(mean ~ year, data=pasadena_temp)
summary(meantemp_lm)
stargazer(meantemp_lm, type = "text")
# p-value: < 2.2 x 10 ^-16 = Significant

## Max model (lm)
maxtemp_lm <- lm(max ~ year, data=pasadena_temp)
summary(maxtemp_lm)
stargazer(maxtemp_lm, type ="text")
# p-value: < 2.2 x 10 ^-16 = Significant

## Min model (lm)
mintemp_lm <- lm(min ~ year, data=pasadena_temp)
summary(mintemp_lm)
stargazer(mintemp_lm, type = "text")
# p-value: < 2.2 x 10 ^-16 = Significant

```




