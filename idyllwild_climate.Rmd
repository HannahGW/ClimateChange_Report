---
title: "Idyllwild Climate"
author: "Hannah Garcia-Wickstrum"
date: "8/11/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(janitor)
library(lubridate)
library(here)
```

```{r}
# Idyllwild Temperature: 1946-2019
# Number of Missing Years: 3

idyllwild_temp <- read_csv("idyllwild_temp.csv") %>%
  clean_names()

# Create graph of averages (mean, max, and min)

idyllwild_temp_graph <- ggplot(data=idyllwild_temp, aes(x=year)) +
  geom_line(aes(y=mean), color="black") +
  geom_line(aes(y=max), color="black") +
  geom_line(aes(y=min), color="black") +
  geom_point(aes(y=mean), color="black", pch=18, size=1.5) +
  geom_point(aes(y=max), color="darkred", pch=15, size=1.5) +
  geom_point(aes(y=min), color="gold", pch=17, size=1.5) +
  labs(x="Year", y="Degrees Farenheit", title="Idyllwild") +
  scale_x_continuous(limits=c(1945, 2020), breaks=seq(1945,2020,10), expand=c(0,1)) +
  scale_y_continuous(limits=c(30,75), breaks=seq(30,75,5), expand=c(0,0)) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

# Need to figure out how to get a trendline on this graph


idyllwild_temp_graph
```

```{r}
# Idyllwild Precipitation: 1948-2019
# Number of Missing Years: 5

# Read in .csv file
idyllwild_precip <- read_csv("idyllwild_precip.csv") %>%
  clean_names()

# Graph of Precipitation (annual - inches)

idyllwild_precip_graph <- ggplot(data=idyllwild_precip, aes(x=years, y=annual_total)) +
  geom_point(pch=18, color="blue") +
  geom_line(color="blue") +
  theme_minimal() +
  labs(title= "Idyllwild", x= "Water Year", y= "Annual Precipitation (inches)") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_x_continuous(limits=c(1945, 2020), breaks=seq(1945,2020,10), expand=c(0,1)) +
  scale_y_continuous(limits=c(10,60), breaks=seq(10,60,10), expand=c(0,0))

idyllwild_precip_graph
```

```{r}
# Graph of 5-yr CV for Idyllwild Precipitation
# Previous report did not graph 5-yr CV for Idyllwild...

idyllwild_precip_cv_graph <- ggplot(data=idyllwild_precip, aes(x=years, y=x5yr_cv)) +
  geom_point(pch=18, color="blue") +
  geom_line(color="blue") +
  theme_minimal() +
  labs(title= "Idyllwild", x= "Water Year", y= "5-Yr CV Annual Precipitation") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_x_continuous(limits=c(1945, 2020), breaks=seq(1945,2020,10), expand=c(0,1))

idyllwild_precip_cv_graph
```

```{r}
# Idyllwild Snowfall: 1946-2019
# Number of Years missing: 13

# Read in csv file
idyllwild_snowfall <- read_csv("idyllwild_snowfall.csv")

# Graph of Snowfall - need to edit the raw data so that the years are not continuous.

idyllwild_snowfall_graph <- ggplot(data=idyllwild_snowfall, aes(x=years, y=annual)) +
  geom_point(pch=18, color="blue") +
  geom_line(color="blue") +
  theme_minimal() +
  labs(title= "Idyllwild", x= "Water Year", y= "Annual Snowfall (inches)") +
  theme(plot.title = element_text(hjust = 0.5))

idyllwild_snowfall_graph
```

