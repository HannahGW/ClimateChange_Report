---
title: "Mt. Wilson No. 2"
author: "Hannah Garcia-Wickstrum"
date: "8/11/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(janitor)
library(lubridate)
library(here)
library(stargazer)
```

```{r}
# Mt. Wilson No. 2 Temperature: 1949-2017
# Number of Missing Years: 3

mtwilson_temp <- read_csv(here::here("csv_files",
                                     "temperature",
                                     "mtwilsonno2.csv")) %>%
  clean_names()


# Create graph of averages (mean, max, and min)

mtwilson_temp_graph <- ggplot(data=mtwilson_temp, aes(x=year)) +
  geom_line(aes(y=mean), color="black") +
  geom_line(aes(y=max), color="black") +
  geom_line(aes(y=min), color="black") +
  geom_point(aes(y=mean), color="black", pch=18, size=1.5) +
  geom_point(aes(y=max), color="darkred", pch=15, size=1.5) +
  geom_point(aes(y=min), color="gold", pch=17, size=1.5) +
  labs(x="Years", y="Degrees Farenheit", title="Mt. Wilson No. 2") +
  scale_x_continuous(limits=c(1945, 2020), breaks=seq(1945,2020,10), expand=c(0,1)) +
  scale_y_continuous(limits=c(40,75), breaks=seq(40,75,5), expand=c(0,0)) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

mtwilson_temp_graph
```

```{r}
# Statistics (linear regression (lm)) for mean, max, and min temperature at Mt. Wilson No. 2
# only add linear regressions if p-value < 0.05
# R2 value 

# Mean model (lm)
meantemp_lm <- lm(mean ~ year, data = mtwilson_temp)
summary(meantemp_lm)
stargazer(meantemp_lm)
# p-value: 1.179 x 10^-12 = Significant

# Max model (lm)
maxtemp_lm <- lm(max ~ year, data = mtwilson_temp)
summary(maxtemp_lm)
stargazer(maxtemp_lm)
# p-value: 2.279 x 10^-14 = Significant

# Min model (lm)
mintemp_lm <- lm(min ~ year, data = mtwilson_temp)
summary(mintemp_lm)
stargazer(mintemp_lm)
# p-value: 4.464 x 10^-7 = Significant

```

```{r}
# Mt. Wilson No. 2 Precipitation Graph

mtwilson_precip <- read_csv(here::here("csv_files",
                                       "precipitation",
                                       "mtwilsonno2_precip.csv"))

# Graph Mt. Wilson No. 2 Precipitation

mtwilson_precip_graph <- ggplot(data=mtwilson_precip, aes(x = year, y = annualgrowingseason)) +
  theme_minimal() +
  geom_point(color = "blue") +
  geom_line(color = "blue") + 
  labs(x="Year", y="Precipitation (inches)", title="Mt. Wilson No. 2") +
  scale_x_continuous(limits=c(1945, 2020), breaks=seq(1945,2020,10), expand=c(0,1)) +
  theme(plot.title = element_text(hjust = 0.5))


mtwilson_precip_graph

```

```{r}
# Statistics for Mt. Wilson No. 2 Precipitation

mtwilsonprecip_lm <- lm(annualgrowingseason ~ year, data=mtwilson_precip)
summary(mtwilsonprecip_lm)
# p-value: 0.5732 = NOT Significant
```

```{r}
# Mt. Wilson No. 2 Snowfall

mtwilson_snowfall <- read_csv(here::here("csv_files",
                                         "snowfall",
                                         "mtwilsonno2_snowfall.csv"))

# Graph of snowfall

mtwilson_snowfall_graph <- ggplot(data=mtwilson_snowfall, aes(x=year, y=total)) +
  theme_minimal() +
  geom_point(color = "blue") +
  geom_line(color = "blue") + 
  labs(x="Year", y="Snowfall (inches)", title="Mt. Wilson No. 2") +
  scale_x_continuous(limits=c(1945, 2020), breaks=seq(1945,2020,10), expand=c(0,1)) +
  theme(plot.title = element_text(hjust = 0.5)) +
  geom_smooth(method='lm', formula= y~x, se=FALSE, color= "black", size=0.5) +
  ggpubr::stat_regline_equation(aes(y=total,x=year), output.type = "expression") 
# Still need to add R and P value on graph? maybe read through this website: https://lukemiller.org/index.php/2012/10/adding-p-values-and-r-squared-values-to-a-plot-using-expression/
  
mtwilson_snowfall_graph # graph is non-functional, do not include on report?

# statistics of Mt. Wilson No. 2 snowfall

mtwilsonsnowfall_lm <- lm(total ~ year, data=mtwilson_snowfall)
summary(mtwilsonsnowfall_lm)
# p-value: 0.0001138 (p < 0.001) Significant (should probably graph the trendline?)
```

